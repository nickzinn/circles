(this.webpackJsonpcircles=this.webpackJsonpcircles||[]).push([[0],{79:function(e,t,i){e.exports=i(91)},85:function(e,t,i){},90:function(e,t,i){},91:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),s=i(14),o=i.n(s),r=(i(84),i(149)),l=i(148),h=i(32),c=i(12),u=i(4),d=i(5),p=i(10),v=i(9),m=(i(85),i(135)),f=i(136),g=i(57),y=i(126),w=i(137),b=i(138),S=i(139),z=i(140),x=i(141),E=i(23),k=["rotate","animate","static"];var O=function(){function e(){Object(u.a)(this,e),this.imageCache=new Map,this.loadsCompleted=0,this.nLoads=0,this.loadCallback=void 0}return Object(d.a)(e,[{key:"registerCallback",value:function(e){this.loadsCompleted===this.nLoads&&e(),this.loadCallback=e}},{key:"getSpriteSheetFromCache",value:function(e){var t=this.imageCache.get(e);if(!t)throw Error("unable to load image: "+e);return t}},{key:"getImageFromCache",value:function(e){var t=this.imageCache.get(e);if(!t)throw Error("unable to load image: "+e);return t.image}},{key:"preLoadImages",value:function(e){var t,i=Object(E.a)(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(-1===k.indexOf(n.type))throw Error("Invalid type: ".concat(n.type));var a=new Image;this.nLoads++,a.src=n.src,a.onload=this._createOnLoad(a,n)}}catch(s){i.e(s)}finally{i.f()}}},{key:"_createOnLoad",value:function(e,t){var i=this;return function(){if(t.noTransparent)i._cache(e,t)();else{var n=function(e){var t=document.createElement("canvas"),i=t.getContext("2d");t.height=e.height,t.width=e.width,i.drawImage(e,0,0);for(var n,a=i.getImageData(0,0,e.width,e.height),s=a.data,o=0,r=0,l=0,h=0,c=0,u=s.length;c<u;c+=4){var d=s[c],p=s[c+1],v=s[c+2];0===c&&(n=[d,p,v]),d===n[0]&&p===n[1]&&v===n[2]&&(s[c]=o,s[c+1]=r,s[c+2]=l,s[c+3]=h)}i.putImageData(a,0,0);var m=document.createElement("img");return m.src=t.toDataURL("image/png"),m}(e);n.onload=i._cache(n,t)}}}},{key:"_cache",value:function(e,t){var i=this;return function(){var n=t.rows?t.rows:1,a=t.columns?t.columns:1,s=new M(e,n,a,t);i.imageCache.set(t.name,s),++i.loadsCompleted===i.nLoads&&i.loadCallback&&i.loadCallback()}}}]),e}(),M=function(){function e(t,i,n,a){Object(u.a)(this,e),this.rows=void 0,this.columns=void 0,this.size=void 0,this.type=void 0,this.frameCount=void 0,this.description=void 0,this.image=void 0,this.srcSize=void 0,this.image=t,this.rows=i,this.columns=n,this.srcSize={width:Math.floor(this.image.width/this.columns),height:Math.floor(this.image.height/this.rows)},a.scale?(this.size={width:Math.floor(this.srcSize.width*a.scale),height:Math.floor(this.srcSize.height*a.scale)},this._preRenderScaledImage(a.scale)):this.size=this.srcSize,this.description=a,this.type=a.type,this.frameCount=this.rows*this.columns}return Object(d.a)(e,[{key:"paint",value:function(e,t,i,n,a){var s,o;"static"===this.description.type?(s=this.description.fixColumn?this.description.fixColumn:0,o=this.description.fixRow?this.description.fixRow:0,i=0):(t=Math.min(t,this.frameCount-1),s=Math.floor(t%this.columns),o=Math.floor(t/this.columns));var r=a.position.x,l=a.position.y;if(o<0||o>=this.rows||s<0||s>=this.columns)throw Error("Row and columns of sprite need to be in bounds (".concat(o,",").concat(s,")"));this.description.angleOffset&&(i+=this.description.angleOffset),i&&(e.translate(r+this.size.width/2,l+this.size.height/2),e.rotate(i),r=0-this.size.width/2,l=0-this.size.height/2);var h=Math.floor(this.image.width*(s/this.columns))+n.position.x,c=Math.floor(this.image.height*(o/this.rows))+n.position.y;e.drawImage(this.image,h,c,n.size.width,n.size.height,r,l,a.size.width,a.size.height),i&&e.setTransform(1,0,0,1,0,0)}},{key:"_preRenderScaledImage",value:function(e){var t=this,i=document.createElement("canvas"),n=i.getContext("2d"),a=this.image,s=Math.floor(a.width*e),o=Math.floor(a.height*e);i.height=o,i.width=s,n.drawImage(this.image,0,0,a.width,a.height,0,0,s,o);var r=document.createElement("img");r.src=i.toDataURL("image/png"),r.onload=function(){t.srcSize={width:Math.floor(s/t.columns),height:Math.floor(o/t.rows)},t.image=r}}}]),e}(),A=i(52),j=function(){function e(t){Object(u.a)(this,e),this.sounds=new Map,this.rate=1,this._mute=!1;var i,n=Object(E.a)(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;this.sounds.set(a.name,new A.Howl({src:a.src,preload:!0}))}}catch(s){n.e(s)}finally{n.f()}this.rate=1,A.Howler.volume(.1),this._mute=!1}return Object(d.a)(e,[{key:"play",value:function(e){var t=this.sounds.get(e);t?(t.rate(this.rate),t.play()):console.log("Sound not found! ".concat(e))}},{key:"mute",get:function(){return this._mute},set:function(e){A.Howler.mute(e),this._mute=e}}]),e}(),C=function(){function e(t,i,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;Object(u.a)(this,e),this.tileSize=void 0,this.tileAtlas=void 0,this.rows=void 0,this.columns=void 0,this.logicGrid=void 0,this.worldSize=void 0,this.age=0,a.forEach((function(e){if(!e||i*n!==e.length)throw Error("Length of array (".concat(!e||e.length,") doesn't match rows(").concat(i,") columns(").concat(n,")."))})),this.tileAtlas=t,this.rows=i,this.columns=n,this.logicGrid=t.convertLogicMapStringToIndex(a),this.tileSize=void 0!==s?s:P(this.logicGrid,t),this.worldSize={width:this.tileSize.width*n,height:this.tileSize.height*i}}return Object(d.a)(e,[{key:"addTile",value:function(e,t,i,n){var a=this.tileAtlas.nameToIndexMap.get(e);if(!a)throw Error("Tile not found");this.logicGrid[t][this.rows*i+n]=a}},{key:"removeTile",value:function(e,t,i){this.logicGrid[e][this.rows*t+i]=-1}},{key:"getRowAtY",value:function(e){return Math.floor(e/this.tileSize.height)}},{key:"getColumnAtX",value:function(e){return Math.floor(e/this.tileSize.width)}},{key:"getTilesAtPosition",value:function(e,t){var i=this.getRowAtY(e.y),n=this.getColumnAtX(e.x);return this.getTilesAt(i,n,t)}},{key:"getTilesAt",value:function(e,t,i){var n=this.logicGrid[i][this.rows*e+t];return-1===n?void 0:this.tileAtlas.getTile(n)}},{key:"paint",value:function(e,t,i){this.age+=i;for(var n=Math.floor(this.age/(1e3/60)),a=this.getRowAtY(e.position.y),s=this.getRowAtY(e.position.y+e.size.height),o=this.getColumnAtX(e.position.x),r=this.getColumnAtX(e.position.x+e.size.width),l=this.worldSize,h=this.tileSize,c=o;c<=r;c++)for(var u=a;u<=s;u++){var d=Math.min(h.width,l.width-c*h.width),p=Math.min(h.height,l.height-u*h.height),v=c*h.width-e.position.x,m=u*h.height-e.position.y,f=0,g=0;if(!(v<0&&(f=-1*v,v=0,(d-=f)<=0))&&(!(m<0&&(g=-1*m,m=0,(p-=g)<=0))&&!(v+d>e.size.width&&(d-=v+d-e.size.width)<=0)&&!(m+p>e.size.height&&(p-=m+p-e.size.height)<=0)))for(var y=0;y<this.logicGrid.length;y++){var w=this.getTilesAt(u,c,y);w&&w.paint(t,n,0,{position:{x:f,y:g},size:{width:d,height:p}},{position:{x:v,y:m},size:{width:d,height:p}})}}}}]),e}();function P(e,t){var i,n=void 0,a=Object(E.a)(e);try{for(a.s();!(i=a.n()).done;){var s,o=i.value,r=Object(E.a)(o);try{for(r.s();!(s=r.n()).done;){var l=s.value;if(-1!==l){n=l;break}}}catch(h){r.e(h)}finally{r.f()}}}catch(h){a.e(h)}finally{a.f()}if(void 0===n)throw Error("Logic Grid is empty!");return t.getTile(n).size}var L=function(){function e(t,i){Object(u.a)(this,e),this.name=void 0,this.size=void 0,this.spriteSheet=void 0,this.spriteSheet=i,this.size=i.size,this.name=t}return Object(d.a)(e,[{key:"paint",value:function(e,t,i,n,a){this.spriteSheet.paint(e,t,i,n,a)}}]),e}(),T=function(){function e(t){Object(u.a)(this,e),this.tiles=[],this.nameToIndexMap=new Map,this.imagePreloader=void 0,this.imagePreloader=t}return Object(d.a)(e,[{key:"getTile",value:function(e){return this.tiles[e]}},{key:"addTile",value:function(e){var t=this.imagePreloader.getSpriteSheetFromCache(e),i=new L(e,t),n=this.tiles.push(i)-1;return this.nameToIndexMap.set(i.name,n),n}},{key:"convertLogicMapStringToIndex",value:function(e){for(var t=[],i=0;i<e.length;i++){for(var n=new Array(e[i].length),a=0;a<e[i].length;a++){var s=e[i][a],o=void 0;s&&0!==s.length?void 0===(o=this.nameToIndexMap.get(s))&&(o=this.addTile(s)):o=-1,n[a]=o}t[i]=n}return t}}]),e}(),B=function(){function e(t){Object(u.a)(this,e),this.debug=!1,this.keysPressed=new Map,this.imagePreloader=void 0,this.soundEffects=void 0,this.canvas=void 0,this.isShutdown=!1,this.pause=!1,this.gameInitializer=void 0,this.touchEvent=void 0,this.tileAtlas=void 0,this._mute=!1,this.readyCallback=void 0,this._scene=void 0,this.events=[],this.gameEventListeners=[],this._timer=0,this.gameInitializer=t,this.soundEffects=new j(t.preloadSounds||[]),this.imagePreloader=new O,this.imagePreloader.preLoadImages(t.preloadImages),this.tileAtlas=new T(this.imagePreloader)}return Object(d.a)(e,[{key:"init",value:function(e,t){var i=this;this.readyCallback=t,this.canvas=e,this.imagePreloader.registerCallback((function(){i._handleImagesLoaded()}))}},{key:"restart",value:function(){var e=this.canvas;if(e.width=window.innerWidth,e.height=window.innerHeight,this.gameInitializer.init(this),!this.scene)throw Error("Game Initializer must set scene.")}},{key:"publishEvent",value:function(e){this.debug&&console.log("Publish Game Event: {".concat(e.type,", ").concat(e.value,"}")),this.events.push(e)}},{key:"subscribeEvent",value:function(e){this.gameEventListeners.push(e)}},{key:"_handleImagesLoaded",value:function(){var e=this,t=this,i=this.canvas,n=function(t){t.preventDefault(),e.keysPressed.set(t.key,!0)},a=function(e){e.preventDefault(),t.keysPressed.delete(e.key)},s=function(n){var a=i.getBoundingClientRect(),s=n.clientX-a.left,o=n.clientY-a.top;n.preventDefault(),t.debug&&console.log("MouseDown Event: (".concat(s,",").concat(o,")")),!t.pause&&t.scene&&(t.scene.handleMouseClick(s,o),e.touchEvent={x:s,y:o})},o=function(t){var n=i.getBoundingClientRect();t.preventDefault(),e.touchEvent&&(e.touchEvent={x:t.clientX-n.left,y:t.clientY-n.top})},r=function(t){e.touchEvent=void 0,t.preventDefault()},l=function(t){var n=i.getBoundingClientRect(),a=t.targetTouches[0];t.preventDefault(),e.touchEvent={x:a.clientX-n.left,y:a.clientY-n.top}},h=function(t){e.touchEvent=void 0,t.preventDefault()},c=function(n){var a=i.getBoundingClientRect(),s=n.targetTouches[0];n.preventDefault(),e.touchEvent={x:s.clientX-a.left,y:s.clientY-a.top},!t.pause&&t.scene&&t.scene.handleMouseClick(e.touchEvent.x,e.touchEvent.y)},u=function(t){e.touchEvent=void 0,t.preventDefault()};window.addEventListener("keydown",n),window.addEventListener("keyup",a),i.addEventListener("mousedown",s),i.addEventListener("mousemove",o),i.addEventListener("mouseup",r),i.addEventListener("touchmove",l,!1),i.addEventListener("touchend",h,!1),i.addEventListener("touchcancel",u,!1),i.addEventListener("touchstart",c,!1);var d=0;this.restart(),requestAnimationFrame((function e(p){if(t.isShutdown)return t.debug&&console.log("shutting down game controller."),window.removeEventListener("keydown",n),window.removeEventListener("keyup",a),i.removeEventListener("mousedown",s),i.removeEventListener("mousemove",o),i.removeEventListener("mouseup",r),i.removeEventListener("touchmove",l,!1),i.removeEventListener("touchend",h,!1),i.removeEventListener("touchcancel",u,!1),void i.removeEventListener("touchstart",c,!1);var v=d?p-d:0;d=p,(v>100||t.pause)&&(v=0);var m=i.getContext("2d"),f=i.width,g=i.height;f===window.innerWidth&&g===window.innerHeight||t.restart(),t._updateScene(m,v),requestAnimationFrame(e)})),this.readyCallback()}},{key:"_updateScene",value:function(e,t){var i=this;if(this.keysPressed.forEach((function(e,t){i.debug&&console.log("KeyPressed Event: ".concat(t)),i.scene.handleKeyPressed(t)})),this.touchEvent&&this.scene.handleTouch(this.touchEvent.x,this.touchEvent.y),e.save(),this.scene.paint({x:0,y:0},e,t),e.restore(),this.scene.updateModel(t),(this._timer+=t)>600&&(window.queueMicrotask((function(){i.events.forEach((function(e){return i.gameEventListeners.forEach((function(t){return t(e)}))})),i.events=[]})),this._timer=0),!this.scene.isAlive&&(this.debug&&console.log("Scene Killed: ".concat(this.scene.name)),this.scene.handleKill(),!this.scene.isAlive))throw Error("Scene is still dead.  Can't have a dead scene (".concat(this.scene.name,")"))}},{key:"scene",set:function(e){this.debug&&console.log("SetScene: ".concat(e.name)),e.debug=this.debug;var t=this.canvas;e.size={width:t.width,height:t.height},this._scene=e,this.touchEvent=void 0},get:function(){return this._scene}},{key:"mute",set:function(e){this._mute=e,this.soundEffects.mute=e},get:function(){return this._mute}}]),e}(),I=i(152),_=i(6),R=i(134),G=i(128),N=i(142),F=i(70),K=i(151),Y=i(133),D=i(130),H=i(131),W=i(129),U=i(125),X=i(68),q=i(124),J=i(132),V=i(127),$=Object(q.a)((function(e){return Object(I.a)({infoButton:{}})}));function Q(){var e=a.a.useState(!1),t=Object(F.a)(e,2),i=t[0],n=t[1],s=$(),o=Object(X.a)(),r=Object(U.a)(o.breakpoints.down("sm")),l=function(){n(!1)};return a.a.createElement("div",null,a.a.createElement(y.a,{edge:"start",className:s.infoButton,onClick:function(){n(!0)},color:"primary","aria-label":"menu"},a.a.createElement(V.a,null)),a.a.createElement(K.a,{fullScreen:r,open:i,onClose:l,"aria-labelledby":"responsive-dialog-title"},a.a.createElement(W.a,{id:"responsive-dialog-title"},"Cicles"),a.a.createElement(D.a,null,a.a.createElement(H.a,null,"A simple 2D game library for JavaScript to teach my kids programming. A demo space game implemented using the library.",a.a.createElement("br",null),a.a.createElement(J.a,{component:"button",variant:"body2",onClick:function(){return window.open("https://github.com/nickzinn/circles")}},"Github Repository"),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(J.a,{variant:"body2"},"nickzinn@gmail.com"))),a.a.createElement(Y.a,null,a.a.createElement(R.a,{onClick:l,color:"primary",autoFocus:!0},a.a.createElement("b",null,"CLOSE")))))}var Z=Object(_.a)((function(e){return Object(I.a)({root:{flexGrow:1},homeButton:{textTransform:"none"},controlButton:{},score:{marginRight:e.spacing(1)},title:{flexGrow:1},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})}))(function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e){var n;return Object(u.a)(this,i),(n=t.call(this,e)).canvasRef=a.a.createRef(),n.gameController=void 0,n.state=void 0,n.gameController=new B(e.gameInitializer),n.state={score:0,imagesLoaded:!1,pause:!1,mute:!1},n}return Object(d.a)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.canvasRef.current;this.gameController.init(t,(function(){return e.setState({imagesLoaded:!0})})),this.gameController.subscribeEvent((function(t){"score"===t.type&&e.setState({score:t.value})}))}},{key:"handleRestart",value:function(e){e.stopPropagation(),this.gameController.restart()}},{key:"handlePause",value:function(e){e.stopPropagation(),this.gameController.pause=!this.gameController.pause,this.setState({pause:this.gameController.pause})}},{key:"handleMute",value:function(e){e.stopPropagation(),this.gameController.mute=!this.gameController.mute,this.setState({mute:this.gameController.mute})}},{key:"componentWillUnmount",value:function(){this.gameController.isShutdown=!0}},{key:"render",value:function(){var e=this,t=this.props.classes;return a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,{position:"static",style:{background:"transparent",boxShadow:"none"}},a.a.createElement(f.a,{variant:"dense"},a.a.createElement(Q,null),a.a.createElement(R.a,{component:h.b,to:"/",className:t.homeButton},a.a.createElement(g.a,{variant:"h5",color:"primary",className:t.title},"Circles")),a.a.createElement(g.a,{variant:"h5",color:"primary",className:t.title},"\xa0"),a.a.createElement(g.a,{variant:"h5",color:"primary",className:t.score},"Score: ",this.state.score),a.a.createElement(y.a,{edge:"start",className:t.controlButton,onClick:function(t){return e.handlePause(t)},color:"primary","aria-label":"menu"},this.state.pause?a.a.createElement(w.a,null):a.a.createElement(b.a,null)),a.a.createElement(y.a,{edge:"start",className:t.controlButton,onClick:function(t){return e.handleRestart(t)},color:"primary","aria-label":"menu"},a.a.createElement(S.a,null)),a.a.createElement(y.a,{edge:"start",className:t.controlButton,onClick:function(t){return e.handleMute(t)},color:"primary","aria-label":"menu"},this.state.mute?a.a.createElement(z.a,null):a.a.createElement(x.a,null)))),a.a.createElement(G.a,{className:t.backdrop,open:!this.state.imagesLoaded},a.a.createElement(N.a,{color:"inherit"})),a.a.createElement("canvas",{id:"Canvas",ref:this.canvasRef}))}}]),i}(a.a.Component)),ee=i(27),te=i(19),ie=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{width:0,height:0};Object(u.a)(this,e),this.name=void 0,this.position=void 0,this.size=void 0,this.isAlive=!0,this.speed=0,this.angle=0,this.acceleration=0,this.canCollide=!1,this.isFixedPosition=!1,this.zOrder=0,this.behaviors=[],this.name=t,this.position=i,this.size=n}return Object(d.a)(e,[{key:"addBehavior",value:function(e){e.init&&e.init(this),this.behaviors.push(e)}},{key:"removeBehavior",value:function(e){var t=this.behaviors.indexOf(e);if(-1===t)throw Error("Behavior not found!");this.behaviors.splice(t,1)}},{key:"paint",value:function(e,t,i){var n=this;this.behaviors.forEach((function(a){var s;return null===(s=a.beforePaint)||void 0===s?void 0:s.call(a,n,e,t,i)})),this.paintStep(e,t,i),this.behaviors.forEach((function(a){var s;return null===(s=a.afterPaint)||void 0===s?void 0:s.call(a,n,e,t,i)}))}},{key:"paintStep",value:function(e,t,i){var n=this;this.behaviors.forEach((function(a){var s;return null===(s=a.paint)||void 0===s?void 0:s.call(a,n,e,t,i)}))}},{key:"updateModel",value:function(e){var t=this;this.behaviors.slice().forEach((function(i){var n;return null===(n=i.updateModel)||void 0===n?void 0:n.call(i,t,e)}))}},{key:"handleKill",value:function(){var e=this;this.behaviors.forEach((function(t){var i;return null===(i=t.handleKill)||void 0===i?void 0:i.call(t,e)}))}}]),e}();function ne(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function ae(e,t){var i=e.size.width,n=e.size.height;if((i|n)<0)return t;var a=t.size.width,s=t.size.height;if((a|s)<0)return e;var o=e.position.x,r=e.position.y;i+=o,n+=r;var l=t.position.x,h=t.position.y;return o>l&&(o=l),r>h&&(r=h),i<(a+=l)&&(i=a),n<(s+=h)&&(n=s),{position:{x:o,y:r},size:{width:i-=o,height:n-=r}}}function se(e,t){var i=e.size.width,n=e.size.height,a=t.size.width,s=t.size.height;if(a<=0||s<=0||i<=0||n<=0)return!1;var o=e.position.x,r=e.position.y,l=t.position.x,h=t.position.y;return s+=h,i+=o,n+=r,((a+=l)<l||a>o)&&(s<h||s>r)&&(i<o||i>l)&&(n<r||n>h)}function oe(e){return{x:e.position.x+e.size.width/2,y:e.position.y+e.size.height/2}}function re(e){return void 0!==e.speed&&void 0!==e.angle?{x:e.speed*Math.cos(e.angle),y:e.speed*Math.sin(e.angle)}:{x:0,y:0}}function le(e,t){var i,n=re(e),a=re(t);return i={x:n.x+a.x,y:n.y+a.y},{angle:Math.atan2(i.y,i.x),speed:Math.hypot(i.x,i.y)}}function he(e,t){var i=e.indexOf(t,0);i>-1&&e.splice(i,1)}var ce=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e,n){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{width:0,height:0};return Object(u.a)(this,i),(a=t.call(this,e)).tileMap=void 0,a.viewPort={x:0,y:0},a.controller=void 0,a.debug=!1,a.wrapAround=!1,a.sceneSpeed=1,a.modelSize=void 0,a.sprites=[],a.collisionListeners=[],a.count=0,a.totalTime=0,a.controller=n,a.modelSize=s,a}return Object(d.a)(i,[{key:"handleKeyPressed",value:function(e){}},{key:"handleMouseClick",value:function(e,t){}},{key:"handleTouch",value:function(e,t){}},{key:"getSpritesAtPoint",value:function(e){return this.sprites.filter((function(t){return function(e,t){return e.x>=t.position.x&&e.x<t.position.x+t.size.width&&e.y>=t.position.y&&e.y<t.position.y+t.size.height}(e,t)}))}},{key:"addSprite",value:function(e){this._handleWrap(e.position,e.size),this._validateSprite(e),e.zOrder||(e.zOrder=0),function(e,t,i){var n=0;if(e.length>0)for(var a=e.length;n<a;){var s=Math.floor((n+a)/2),o=i(e[s],t);if(o<0)n=s+1;else{if(!(o>0)){n=s;break}a=s}}e.splice(n,0,t)}(this.sprites,e,(function(e,t){return e.zOrder-t.zOrder})),e.priorPosition=e.position,e.handleCollision&&this.collisionListeners.push(e)}},{key:"removeSprite",value:function(e){var t;null===(t=e.handleKill)||void 0===t||t.call(e),this.debug&&console.log("Remove sprite(".concat(e.name,") (").concat(e.position.x,", ").concat(e.position.y,")")),he(this.sprites,e),he(this.collisionListeners,e)}},{key:"resetGame",value:function(){this.sprites=[],this.collisionListeners=[]}},{key:"setTiles",value:function(e,t,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;this.tileMap=new C(this.controller.tileAtlas,e,t,i,a),n&&(this.modelSize=this.tileMap.worldSize)}},{key:"updateModel",value:function(e){Object(ee.a)(Object(te.a)(i.prototype),"updateModel",this).call(this,e),this.handleMovement(e)}},{key:"handleMovement",value:function(e){for(var t=e/1e3,i=this.sprites.slice();i.length;){var n=i.pop();if(n.isAlive){var a=void 0;if(!n.isFixedPosition){var s={position:ne(n.position),size:n.size},o=re(n),r={x:n.position.x+o.x*t*this.sceneSpeed,y:n.position.y+o.y*t*this.sceneSpeed},l=this._handleWrap(r,n.size);n.priorPosition=s.position,n.position=r,a={position:ne(n.position),size:n.size},l||(a=ae(s,a)),n.acceleration&&(Math.sign(n.acceleration+n.speed)!==Math.sign(n.speed)?n.speed=0:n.speed=n.speed+n.acceleration)}n.canCollide&&(a||(a=n),this._handleCollision(a,n)),n.updateModel&&n.updateModel(e);var h=this._validateSprite(n);h&&(console.log("Sprite position not valid.  Killing spite (".concat(n.name,"). ").concat(h)),n.isAlive=!1),n.isAlive||this.removeSprite(n)}else this.removeSprite(n)}}},{key:"_handleCollision",value:function(e,t){var i;if(t.handleCollision)for(var n=0;n<this.sprites.length;n++){var a=this.sprites[n];if(t!==a&&a.canCollide&&se(e,a)){t.handleCollision(a),i=a;break}}i||(i=t);for(var s=0;s<this.collisionListeners.length;s++){var o=this.collisionListeners[s];if(t!==o&&se(e,o)){o.handleCollision(t),i=o;break}}i.isAlive||this.removeSprite(i)}},{key:"paint",value:function(e,t,i){e={x:e.x+this.viewPort.x,y:e.y+this.viewPort.y},this.paintBackground(t),this.tileMap&&this.tileMap.paint({position:e,size:this.size},t,i);var n,a=0,s=Object(E.a)(this.sprites);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(!o.isAlive)throw Error("No Dead Sprites Should Make it to render step.\n"+o);var r=ne(o.position);o.isFixedPosition||(r={x:r.x-e.x,y:r.y-e.y}),r.x>this.size.width||r.y>this.size.height||o.size.width+r.x<0||o.size.height+r.y<0||(o.paint(r,t,i),a++)}}catch(l){s.e(l)}finally{s.f()}this.debug&&(++this.count%300===0?(this.totalTime=i,this.count=1):this.totalTime+=i,t.fillStyle="red",t.font="8px Electrolize",t.fillText("FPS: ".concat(Math.round(1e3/(this.totalTime/++this.count))," Alive: ").concat(this.sprites.length," On Screen: ").concat(a," Collision Handlers: ").concat(this.collisionListeners.length),10,this.size.height-10))}},{key:"paintBackground",value:function(e){e.fillStyle="black",e.fillRect(0,0,this.size.width,this.size.height)}},{key:"addSprites",value:function(e){var t=this;if(!e||!e.length)throw Error("Attempting to add empty array of sprites in scene (".concat(this.name,")"));this.debug&&console.log("Bulk adding ".concat(e.length," of type (").concat(e[0].name,")")),e.forEach((function(e){return t.addSprite(e)}))}},{key:"_validateSprite",value:function(e){if(e.position.x<0||e.position.y<0)return"Sprite position less 0 (".concat(e.position.x,", ").concat(e.position.y,")");if(0!==this.modelSize.width){if(e.position.x>=this.modelSize.width||e.position.y>=this.modelSize.height)return"Sprite position(".concat(e.position.x,", ").concat(e.position.y,") > model(").concat(this.modelSize.width,",").concat(this.modelSize.height,")")}else if(e.position.x>=this.size.width||e.position.y>=this.size.height)return"Sprite position(".concat(e.position.x,", ").concat(e.position.y,")  > screen(").concat(this.size.width,",").concat(this.size.height,")");return e.size.width<=0||e.size.height<=0?"Sprite size too small (".concat(e.size.width,", ").concat(e.size.height,")"):void 0!==e.speed&&void 0===e.angle||void 0===e.speed&&void 0!==e.angle?"Either speed(".concat(e.speed,") and angle(").concat(e.angle,") are both defined or both undefined."):void 0}},{key:"_handleWrap",value:function(e,t){var i=!1;if(this.wrapAround){var n=this.size.width,a=this.size.height;0!==this.modelSize.width&&(n=this.modelSize.width,a=this.modelSize.height),e.x<0?(e.x=n-t.width,i=!0):e.x+t.width>n&&(e.x=0,i=!0),e.y<0?(e.y=a-t.height,i=!0):e.y+t.height>a&&(e.y=0,i=!0)}return i}}]),i}(ie),ue=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(u.a)(this,e),this.spriteSheet=void 0,this.framesPerSecond=25,this.age=0,this.animateOnce=void 0,this.rotate=!1,this.spriteSheet=t,this.animateOnce=i}return Object(d.a)(e,[{key:"init",value:function(e){e.size=this.spriteSheet.size}},{key:"paint",value:function(e,t,i,n){var a;if("rotate"===this.spriteSheet.type)(a=Math.floor(Math.abs(this.getAngle(e))%(2*Math.PI)/(2*Math.PI)*this.spriteSheet.frameCount*2))>=this.spriteSheet.frameCount&&(a=2*this.spriteSheet.frameCount-a-1);else if(this.framesPerSecond&&0!==this.spriteSheet.frameCount){var s=1/this.framesPerSecond;a=Math.floor(this.age/s%this.spriteSheet.frameCount)}else a=0;a=Math.min(a,this.spriteSheet.frameCount-1);var o=this.getAngle(e);this.spriteSheet.paint(i,a,o,{position:{x:0,y:0},size:e.size},{position:t,size:e.size})}},{key:"updateModel",value:function(e,t){var i=t/1e3;this.age+=i,this.animateOnce&&this.age>this.spriteSheet.frameCount/this.framesPerSecond&&(e.isAlive=!1)}},{key:"getAngle",value:function(e){return e.angle?e.angle:0}}]),e}(),de=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e,n){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(u.a)(this,i),(a=t.call(this,n,s)).scene=void 0,a.spriteSheetBehavior=void 0,a.scene=e;var r=e.controller.imagePreloader.getSpriteSheetFromCache(n);return a.spriteSheetBehavior=new ue(r,o),a.addBehavior(a.spriteSheetBehavior),a}return Object(d.a)(i,[{key:"animateOnce",set:function(e){this.spriteSheetBehavior.animateOnce=e},get:function(){return this.spriteSheetBehavior.animateOnce}}]),i}(ie),pe=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"100px Electrolize",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80;return Object(u.a)(this,i),(n=t.call(this,"CountdownTimer")).timeInMillis=void 0,n.fontStyle=void 0,n.age=0,n.color=void 0,n.fontHeight=void 0,n.timeInMillis=e,n.fontStyle=s,n.size={width:o*Math.floor(e/2500).toString().length,height:o},n.color=a,n.fontHeight=o,n}return Object(d.a)(i,[{key:"paint",value:function(e,t,i){var n=Math.floor((this.timeInMillis-this.age)/1e3).toString();t.fillStyle=this.color,t.font=this.fontStyle,t.fillText(n,e.x,e.y+this.size.height)}},{key:"updateModel",value:function(e){this.age+=e,this.age>this.timeInMillis&&(this.isAlive=!1)}}]),i}(ie),ve=function(){function e(t,i,n){Object(u.a)(this,e),this.name="Title",this.position={x:0,y:0},this.size={width:1,height:1},this.speed=0,this.angle=0,this.isAlive=!0,this.zOrder=100,this.canCollide=!1,this.isFixedPosition=!0,this.title=void 0,this.subtitle1=void 0,this.subtitle2=void 0,this.title=t,this.subtitle1=i,this.subtitle2=n}return Object(d.a)(e,[{key:"paint",value:function(e,t,i){var n=t.canvas.width,a=t.canvas.height,s=t.font;function o(e,i,n,a){t.fillStyle="grey",t.fillText(e,i+a,n+a),t.fillStyle="white",t.fillText(e,i,n)}t.font=n>400?n>500?n>800?n>1e3?"110px Electrolize":"80px Electrolize":"60px Electrolize":"40px Electrolize":"30px Electrolize";var r=t.measureText(this.title),l=a/3;o(this.title,(n-r.width)/2,l,3);var h=n>500?n>800?30:24:18;t.font="".concat(h,"px Electrolize"),r=t.measureText(this.subtitle1),l+=2*h,o(this.subtitle1,(n-r.width)/2,l,1),r=t.measureText(this.subtitle2),l+=2*h,o(this.subtitle2,(n-r.width)/2,l,1),t.font=s}}]),e}();function me(e,t,i){return{name:"wall",position:e,size:t,isAlive:!0,canCollide:!1,speed:0,angle:0,paint:function(i,n,a){n.fillStyle="\trgb(50,50,50)",n.fillRect(e.x,e.y,t.width,t.height)},handleCollision:function(e){var t=re(e);i?(t.x>0?e.position.x=this.position.x-e.size.width:e.position.x=this.position.x+this.size.width,e.position.y=e.priorPosition.y,e.angle=Math.PI-e.angle+.2*(Math.random()-.5)):(t.y>0?e.position.y=this.position.y-e.size.height:e.position.y=this.position.y+this.size.height,e.position.x=e.priorPosition.x,e.angle=-1*e.angle+.2*(Math.random()-.5))}}}var fe=function(){function e(){Object(u.a)(this,e),this.preloadImages=[{name:"ball",src:"/circles/assets/images/ball.png",rows:4,columns:8,type:"animate"}],this.preloadSounds=[{name:"boop",src:"/circles/assets/sounds/boop.wav"},{name:"error",src:"/circles/assets/sounds/error.wav"}]}return Object(d.a)(e,[{key:"init",value:function(e){this.launchInstructions(e)}},{key:"launchGame",value:function(e){var t=this,i=new ce("bouncing ball",e);e.scene=i;var n=0;e.publishEvent({type:"score",value:n}),i.handleMouseClick=function(t,a){var s=i.getSpritesAtPoint({x:t,y:a});s.length?s.filter((function(e){return e.canCollide})).forEach((function(t){"CountdownTimer"!==t.name&&(i.removeSprite(t),e.publishEvent({type:"score",value:++n}),e.soundEffects.play("boop"))})):(e.publishEvent({type:"score",value:--n}),e.soundEffects.play("error"))},i.wrapAround=!1;var a=i.size;i.addSprite(me({x:0,y:0},{width:a.width-4,height:4},!1)),i.addSprite(me({x:0,y:a.height-4},{width:a.width,height:4},!1)),i.addSprite(me({x:0,y:0},{width:4,height:a.height-4},!0)),i.addSprite(me({x:a.width-4,y:0},{width:4,height:a.height-4},!0));for(var s=function(e,t){return Math.random()*(t-e)+e},o=function(e){return{x:s(a.width-2*(e+4),e+4),y:s(a.height-2*(e+4),e+4)}},r=0;r<30;r++){var l=new de(i,"ball"),h=l.size.width/2;l.position=o(h),l.isAlive=!0,l.speed=250*Math.random()+100,l.angle=Math.random()*Math.PI*2,l.zOrder=10*Math.random()-5,l.canCollide=!0,l.size={width:l.size.width-2,height:l.size.height-2},i.addSprite(l)}var c=new pe(15e3);c.position=o(c.size.width),c.speed=500,c.angle=Math.random()*Math.PI*2,c.zOrder=1,c.canCollide=!0,c.handleKill=function(){return t.launchGameOverScene(e,n)},i.addSprite(c)}},{key:"launchGameOverScene",value:function(e,t){var i=this,n=new ce("GameOver",e);e.scene=n;var a=0;n.addBehavior({updateModel:function(e,t){return a+=t}}),n.handleKeyPressed=function(){a>1e3&&i.launchGame(e)},n.handleMouseClick=function(){a>1e3&&i.launchGame(e)};var s=t>10;return n.addSprite(new ve(s?"YOU WIN!!!":"YOU LOSE","".concat(s?"Awesome,":"Times Up!"," Score ").concat(t),"HIT ANY KEY TO PLAY AGAIN")),n}},{key:"launchInstructions",value:function(e){var t=this,i=new ce("Intro",e);return e.scene=i,i.handleKeyPressed=function(){return t.launchGame(e)},i.handleMouseClick=function(){return t.launchGame(e)},i.addSprite(new ve("CLICK THE BALLS","You have 15 seconds. Don't miss.","HIT ANY KEY TO PLAY")),i}}]),e}();function ge(e,t){for(var i=e.controller.scene.size,n=function(e,t){return Math.random()*(t-e)+e},a=[],s=0;s<t;s++){var o=new de(e,"asteroid",{x:n(i.width-100,100),y:n(i.height-100,100)});o.speed=200*Math.random()+50,o.angle=Math.random()*Math.PI*2,o.zOrder=-1,o.canCollide=!0,o.size={width:o.size.width,height:o.size.height},a.push(o)}return a}var ye=i(31),we=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e){var n;Object(u.a)(this,i),(n=t.call(this,"Radar")).scene=void 0;var a=Math.floor(14*e.size.width/16)-3,s=e.size.width-3-a,o=Math.floor(s/e.modelSize.width*e.modelSize.height);return n.position={x:a-3,y:53},n.size={width:s,height:o},n.isFixedPosition=!0,n.zOrder=100,n.scene=e,n.canCollide=!1,n}return Object(d.a)(i,[{key:"paint",value:function(e,t,i){t.strokeStyle="white",t.strokeRect(e.x-1,e.y-1,this.size.width+2,this.size.height+2),t.fillStyle="white";var n,a=this.size.width/this.scene.modelSize.width,s=Object(E.a)(this.scene.sprites);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(o!==this){var r=Math.floor(e.x+o.position.x*a),l=Math.floor(e.y+o.position.y*a),h=2;"enemy"===o.name?t.fillStyle="red":"player"===o.name&&(t.fillStyle="green",h=3),t.fillRect(r,l,h,h),t.fillStyle="white"}}}catch(v){s.e(v)}finally{s.f()}t.strokeStyle="red";var c=Math.floor(this.scene.viewPort.x*a+e.x),u=Math.floor(this.scene.viewPort.y*a+e.y),d=Math.floor(this.scene.size.width*a),p=Math.floor(this.scene.size.height*a);t.strokeRect(c,u,d,p)}}]),i}(ie),be=function(){function e(t){Object(u.a)(this,e),this.age=0,this.expirationTime=void 0,this.expirationTime=t}return Object(d.a)(e,[{key:"updateModel",value:function(e,t){this.age+=t,this.age>this.expirationTime&&(e.isAlive=!1)}}]),e}();function Se(e,t){return xe(e,t,"explosionSmall")}function ze(e,t){return xe(e,t,"explosionBig")}function xe(e,t,i){var n=new de(e,i,t,!0);return n.position={x:t.x-n.size.width/2,y:t.y-n.size.height/2},e.controller.soundEffects.play(i),n}var Ee=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e,n,a){var s;return Object(u.a)(this,i),(s=t.call(this,e,a,n)).shipAngle=void 0,s.lastMissleFired=void 0,s.shipAngle=0,s.speed=0,s.angle=0,s.acceleration=-.1,s.canCollide=!0,s.spriteSheetBehavior.getAngle=function(){return s.shipAngle},s}return Object(d.a)(i,[{key:"left",value:function(){this.shipAngle+=-.1}},{key:"right",value:function(){this.shipAngle+=.1}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,t=le(this,{speed:e,angle:this.shipAngle});this.angle=t.angle,this.speed=Math.min(t.speed,375)}}]),i}(de),ke=function(){function e(t){Object(u.a)(this,e),this.age=0,this.expirationTime=void 0,this.expirationTime=t}return Object(d.a)(e,[{key:"updateModel",value:function(e,t){var i;(this.age+=t,this.age>this.expirationTime)&&(e.removeBehavior(this),null===(i=this.handleTimeUp)||void 0===i||i.call(this,e))}}]),e}(),Oe=["lighten","source-over"],Me=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"lighten";if(Object(u.a)(this,i),(n=t.call(this,a)).spriteSheet=void 0,n.compositeOperation=void 0,n.blendAmount=void 0,!Oe.includes(o))throw Error("Unsupported composite operation: ".concat(o));return n.spriteSheet=e,n.compositeOperation=o,n.blendAmount=s,n}return Object(d.a)(i,[{key:"updateModel",value:function(e,t){-1!==this.expirationTime&&Object(ee.a)(Object(te.a)(i.prototype),"updateModel",this).call(this,e,t)}},{key:"afterPaint",value:function(e,t,i,n){if(this.blendAmount<0||this.blendAmount>1)throw Error("Blend amount must be between 0 and 1.0, not ".concat(this.blendAmount));if(!e)throw Error("Sprite must be defined.");var a=oe({position:t,size:e.size}),s=this.spriteSheet.size.width,o=this.spriteSheet.size.height,r={x:Math.floor(a.x-s/2),y:Math.floor(a.y-o/2)};i.save(),i.globalAlpha=this.blendAmount,i.globalCompositeOperation=this.compositeOperation;var l=this.spriteSheet.size;this.spriteSheet.paint(i,0,0,{position:{x:0,y:0},size:l},{position:r,size:l}),i.restore()}}]),i}(ke),Ae=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e,n){var a;return Object(u.a)(this,i),(a=t.call(this,e,n,"player")).shield=100,a.acceleration=-4,a}return Object(d.a)(i,[{key:"updateModel",value:function(e){Object(ee.a)(Object(te.a)(i.prototype),"updateModel",this).call(this,e);var t=this.scene.viewPort,n=this.scene.size,a=n.width/3,s=n.height/3,o=ne(this.position);o.x<t.x+a?t.x=o.x-a:o.x>t.x+n.width-a&&(t.x=o.x-n.width+a),o.y<t.y+s?t.y=o.y-s:o.y>t.y+n.height-s&&(t.y=o.y-n.height+s),this.scene.viewPort={x:Math.min(Math.max(t.x,0),this.scene.modelSize.width-n.width),y:Math.min(Math.max(t.y,0),this.scene.modelSize.height-n.height)}}},{key:"animateShield",value:function(){var e=this.scene.controller.imagePreloader.getSpriteSheetFromCache("shield"),t=Math.min(Math.max(.15,this.shield/100+.15),1);this.addBehavior(new Me(e,500,t))}},{key:"handleCollision",value:function(e){"asteroid"!==e.name||this.scene.pause||(this.scene.hit(10),this.scene.addSprite(Se(this.scene,oe(e))),e.isAlive=!1)}}]),i}(Ee),je=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e){var n;return Object(u.a)(this,i),(n=t.call(this,e,{x:Math.floor(Math.random()*e.modelSize.width),y:50},"enemy")).count=0,n.speed=100,n.angle=Math.random(),n.shipAngle=0,n}return Object(d.a)(i,[{key:"updateModel",value:function(e){Object(ee.a)(Object(te.a)(i.prototype),"updateModel",this).call(this,e);var t=this.position.x-this.scene.player.position.x,n=this.position.y-this.scene.player.position.y,a=Math.hypot(t,n);if(!(a>1500)){var s=Math.atan2(n,t),o=Math.sin(s-this.shipAngle);o>.1?this.shipAngle-=.1:o<-.1?this.shipAngle+=.1:this.count++%Math.max(100-20*this.scene.level,30)===0&&a<600&&this.scene.fire(this),a>300&&this.move()}}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;Object(ee.a)(Object(te.a)(i.prototype),"move",this).call(this,e),this.speed=Math.min(this.speed,300)}}]),i}(Ee),Ce=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;Object(u.a)(this,e),this.alpha=void 0,this.lastLocation=[],this.delay=void 0,this.alpha=t,this.delay=i}return Object(d.a)(e,[{key:"beforePaint",value:function(e,t,i,n){if(this.lastLocation.length>=this.delay&&n>0&&(s=this.lastLocation[0],o=t,s.x!==o.x||s.y!==o.y)){var a=i.globalAlpha;i.globalAlpha=this.alpha,e.paintStep(this.lastLocation[0],i,n),i.globalAlpha=a}var s,o;this.lastLocation.push(t),this.lastLocation.length>this.delay&&(this.lastLocation=this.lastLocation.slice(2))}}]),e}(),Pe=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e,n,a,s,o,r){var l;return Object(u.a)(this,i),(l=t.call(this,o,"missle",e)).owner=void 0,l.behavior=void 0,l.owner=s,l.angle=n,l.speed=a,l.acceleration=10,l.canCollide=!0,l.behavior=new be(r),l.addBehavior(l.behavior),l.addBehavior(new Ce(.2)),l}return Object(d.a)(i,[{key:"handleCollision",value:function(e){e!==this.owner&&"missle"!==e.name&&(this.isAlive=!1,this.scene.missleHit(this.owner,e))}}]),i}(de);var Le=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(){var e;Object(u.a)(this,i);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).oldAlpha=1,e}return Object(d.a)(i,[{key:"beforePaint",value:function(e,t,i,n){this.oldAlpha=i.globalAlpha,i.globalAlpha=Math.min(1-this.age/this.expirationTime,1)}},{key:"afterPaint",value:function(e,t,i,n){i.globalAlpha=this.oldAlpha}}]),i}(ke),Te=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(){var e;Object(u.a)(this,i);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).oldAlpha=1,e}return Object(d.a)(i,[{key:"beforePaint",value:function(e,t,i,n){this.oldAlpha=i.globalAlpha,i.globalAlpha=Math.min(this.age/this.expirationTime,1)}},{key:"afterPaint",value:function(e,t,i,n){i.globalAlpha=this.oldAlpha}}]),i}(ke),Be=function(e){Object(p.a)(i,e);var t=Object(v.a)(i);function i(e,n,a){var s;Object(u.a)(this,i),(s=t.call(this,"MainGameScene",e))._score=0,s.level=void 0,s.stars=[],s.player=void 0,s.alienCount=void 0,s.pause=!1,s.setTiles(3,3,[new Array(9).fill("MainGameScene")],!1),s.level=n,s.score=a,e.scene=Object(ye.a)(s),s.modelSize={width:3*s.size.width,height:3*s.size.height};var o=s.modelSize.width*s.modelSize.height;s.wrapAround=!0,s.addSprites(function(e,t){var i=ge(e,t);return i.forEach((function(t){t.position.x=Math.random()*e.modelSize.width,t.position.y=0,t.speed=100*Math.random()+50})),i}(Object(ye.a)(s),Math.floor(o/3e5*(.6+.4*n)))),s.addSprite(new we(Object(ye.a)(s)));var r={x:s.modelSize.width/2,y:s.modelSize.height/2};s.viewPort={x:r.x-s.size.width/2,y:r.y-s.size.height/2},s.player=new Ae(Object(ye.a)(s),r),s.player.addBehavior(new Te(500)),s.addSprite(s.player),s.alienCount=n;for(var l=0;l<s.alienCount;l++)s.addSprite(new je(Object(ye.a)(s)));return s.speed=1,s}return Object(d.a)(i,[{key:"fire",value:function(e){if(!(e.lastMissleFired&&e.lastMissleFired.behavior.age<125&&e.lastMissleFired.isAlive)){var t,i=oe(e),n={x:i.x+Math.cos(e.shipAngle)*e.size.width,y:i.y+Math.sin(e.shipAngle)*e.size.height};this.player===e?(t=1500,this.controller.soundEffects.play("missle")):(t=1e3,this.controller.soundEffects.play("alienMissle"));var a=new Pe(n,e.shipAngle,e.speed+50,e,this,t);e.lastMissleFired=a,this.addSprite(a)}}},{key:"handleKeyPressed",value:function(e){if(!this.pause)switch(e){case"a":case"ArrowLeft":this.player.left();break;case"w":case"ArrowUp":this.player.move();break;case"s":case"ArrowDown":this.player.move(-15);break;case"d":case"ArrowRight":this.player.right();break;case" ":this.fire(this.player)}}},{key:"gameOver",value:function(){var e=this;this.pause||(this.pause=!0,this.controller.soundEffects.play("gameOver"),this.addBehavior(new be(4e3)),this.addBehavior({handleKill:function(){e.controller.gameInitializer.highscore<e.score&&(e.controller.gameInitializer.highscore=e.score,e.controller.soundEffects.play("newHighScore")),Ie(e.controller)}}))}},{key:"nextLevel",value:function(){var e=this;this.pause=!0,this.addBehavior(new be(3e3));var t=new Le(2e3);t.handleTimeUp=function(){return e.player.isAlive=!1},this.player.addBehavior(t),this.addBehavior({handleKill:function(){return function(e,t,i){var n=new ce("BetweenLevelScene",e);return n.setTiles(3,3,[new Array(9).fill("BetweenLevelScene")],!1),e.scene=n,e.publishEvent({type:"score",value:i}),n.wrapAround=!0,n.handleKeyPressed=function(n){new Be(e,t+1,i)},n.handleMouseClick=function(){return new Be(e,t+1,i)},n.addSprite(new ve("LEVEL ".concat(t," COMPLETE"),"Score ".concat(i),"HIT ANY KEY FOR NEXT LEVEL")),n.addSprites(ge(n,30)),n.controller.soundEffects.play("levelComplete"),n}(e.controller,e.level,e.score)}})}},{key:"hit",value:function(e){if(!this.pause)if(this.player.shield-e<=0){var t=oe(this.player);this.addSprite(ze(this,t)),this.player.isAlive=!1,this.gameOver()}else this.player.shield-=e,this.player.animateShield()}},{key:"missleHit",value:function(e,t){this.debug&&console.log("Missle from ".concat(e.name," hits sprite ").concat(t.name)),this.pause||("player"===t.name?this.hit(49):"enemy"===t.name&&e===this.player?(t.isAlive=!1,this.addSprite(ze(this,oe(t))),this.score+=50,0===--this.alienCount&&this.nextLevel()):e===this.player&&"asteroid"===t.name&&(t.isAlive=!1,this.addSprite(Se(this,oe(t))),this.score+=5))}},{key:"handleMouseClick",value:function(e,t){this.pause||(this.handleTouch(e,t),this.fire(this.player))}},{key:"handleTouch",value:function(e,t){if(!this.pause){var i=this.player.position.x-e-this.viewPort.x,n=this.player.position.y-t-this.viewPort.y,a=Math.hypot(i,n),s=Math.atan2(n,i),o=Math.sin(s-this.player.shipAngle);o>.1?this.player.shipAngle-=.05:o<-.1&&(this.player.shipAngle+=.05),a>100?(this.player.move(),this.acceleration=-1):this.acceleration=-5}}},{key:"score",set:function(e){this._score=e,this.controller.publishEvent({type:"score",value:this.score})},get:function(){return this._score}}]),i}(ce);function Ie(e){var t=new ce("OpeningScene",e);t.setTiles(3,3,[new Array(9).fill("OpeningScene")],!1),e.scene=t,e.publishEvent({type:"score",value:0}),t.wrapAround=!0,t.handleKeyPressed=function(t){new Be(e,1,0)},t.handleMouseClick=function(){return new Be(e,1,0)},t.addSprite(new ve("Space Hunter","High Score ".concat(e.gameInitializer.highscore),"HIT ANY KEY FOR NEW GAME")),t.addSprites(ge(t,30))}var _e=function(){function e(){Object(u.a)(this,e),this.highscore=0,this.preloadImages=[{name:"asteroid",src:"/circles/assets/images/asteroid.png",rows:2,columns:10,type:"animate"},{name:"player",src:"/circles/assets/images/ship_anim.png",rows:1,columns:24,scale:.4,angleOffset:Math.PI/2,type:"rotate"},{name:"shield",src:"/circles/assets/images/shield.png",scale:.3,type:"static"},{name:"enemy",src:"/circles/assets/images/Enemy.png",scale:.8,type:"animate"},{name:"explosionSmall",src:"/circles/assets/images/ExplosionSheetSmall.png",rows:4,columns:4,type:"animate"},{name:"explosionBig",src:"/circles/assets/images/ExplosionSheet2.png",rows:6,columns:8,type:"animate"},{name:"missle",src:"/circles/assets/images/Laser.png",type:"animate"},{name:"OpeningScene",src:"/circles/assets/images/Scene.jpg",noTransparent:!0,type:"static"},{name:"MainGameScene",src:"/circles/assets/images/starfield_alpha2.png",noTransparent:!0,type:"static"},{name:"BetweenLevelScene",src:"/circles/assets/images/Scene.jpg",noTransparent:!0,type:"static"}],this.preloadSounds=[{name:"missle",src:"/circles/assets/sounds/missle_fire.wav"},{name:"alienMissle",src:"/circles/assets/sounds/alien_missle_fire.wav"},{name:"gameOver",src:"/circles/assets/sounds/game_over.wav"},{name:"levelComplete",src:"/circles/assets/sounds/level_complete.wav"},{name:"explosionSmall",src:"/circles/assets/sounds/small_explosion.wav"},{name:"explosionBig",src:"/circles/assets/sounds/big_explosion.wav"},{name:"newHighScore",src:"/circles/assets/sounds/new_high_score.wav"}]}return Object(d.a)(e,[{key:"init",value:function(e){Ie(e)}}]),e}(),Re=i(41),Ge=i(144),Ne=i(145),Fe=i(147),Ke=i(146),Ye=i(150),De=i(143),He=Object(q.a)((function(e){var t;return{appBar:{position:"relative"},container:(t={marginTop:e.spacing(3),marginBottom:e.spacing(2),padding:e.spacing(2)},Object(Re.a)(t,e.breakpoints.up(600+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)}),Object(Re.a)(t,"overflowY","auto"),t),root:{maxWidth:345,marginBottom:e.spacing(3)},media:{height:140},link:{textDecoration:"none"},githublink:{marginLeft:e.spacing(3)}}}));function We(){var e=He();return a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,{position:"absolute",color:"default",className:e.appBar},a.a.createElement(f.a,null,a.a.createElement(g.a,{variant:"h6",color:"inherit",noWrap:!0},"Circles"))),a.a.createElement(Ye.a,{component:"div",overflow:"visible"},a.a.createElement(De.a,{container:!0,alignItems:"center",justify:"center",direction:"column",className:e.container},a.a.createElement(Ge.a,{className:e.root},a.a.createElement(h.b,{to:"/space",className:e.link},a.a.createElement(Ne.a,null,a.a.createElement(Ke.a,{className:e.media,image:"/circles/assets/images/asteroids-screen.png",title:"Play Asteroids"}),a.a.createElement(Fe.a,null,a.a.createElement(g.a,{gutterBottom:!0,variant:"h5",component:"h2"},"Play Space Hunter"),a.a.createElement(g.a,{variant:"body2",color:"textSecondary",component:"p"},"Shoot all the alien ships!  Use mouse, touch, or W-A-S-D to move around and space bar to fire.  Watch out for the enemy..."))))),a.a.createElement(Ge.a,{className:e.root},a.a.createElement(h.b,{to:"/ball",className:e.link},a.a.createElement(Ne.a,null,a.a.createElement(Ke.a,{className:e.media,image:"/circles/assets/images/balls-screen.png",title:"Play Bouncing Ball"}),a.a.createElement(Fe.a,null,a.a.createElement(g.a,{gutterBottom:!0,variant:"h5",component:"h2"},"Play Bouncing Ball"),a.a.createElement(g.a,{variant:"body2",color:"textSecondary",component:"p"},"Try to catch the balls.  If you miss your score goes down, so be careful!  Built this to test the library."))))),a.a.createElement(J.a,{component:"button",variant:"body2",className:e.githublink,onClick:function(){return window.open("https://github.com/nickzinn/circles")}},"Github Repository"))))}function Ue(){return a.a.createElement(h.a,{hashType:"noslash"},a.a.createElement(c.c,null,a.a.createElement(c.a,{path:"/space"},a.a.createElement(Z,{gameInitializer:new _e})),a.a.createElement(c.a,{path:"/ball"},a.a.createElement(Z,{gameInitializer:new fe})),a.a.createElement(c.a,{path:"/"},a.a.createElement(We,null))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i(90);var Xe=i(69),qe=Object(Xe.a)({typography:{fontFamily:"Electrolize"},overrides:{MuiCssBaseline:{"@global":{body:{width:"100%",height:"100%",margin:"0"}}}}});qe.typography.h5=Object(Re.a)({fontSize:"18px","@media (min-width:600px)":{fontSize:"22px"}},qe.breakpoints.up("md"),{fontSize:"28px"});var Je=qe;o.a.render(a.a.createElement(l.a,{theme:Je},a.a.createElement(r.a,null),a.a.createElement(Ue,null)),document.querySelector("#root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[79,1,2]]]);
//# sourceMappingURL=main.b61388a5.chunk.js.map